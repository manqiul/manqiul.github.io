<!DOCTYPE html>
<html lang="en">

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  Manqiu  L.


  | Support Vector Machine Math and Optimization

</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://gitcdn.link/repo/jwarby/jekyll-pygments-themes/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üåå</text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="https://manqiul.github.io/blog/2021/svm/">


<!-- Dark Mode -->
<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://manqiul.github.io/">
       <span class="font-weight-bold">Manqiu</span>   L.
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              About
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              Blog
              
            </a>
          </li>
          
          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/courses/">
                Courses
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/experiences/">
                Experiences
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Interests
                
              </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
              
              
                <a class="dropdown-item" href="/photography/">Photography</a>
              
              
              
                <div class="dropdown-divider"></div>
              
              
              
                <a class="dropdown-item" href="/reading/">Reading</a>
              
              
              </div>
          </li>
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                Projects
                
              </a>
          </li>
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
            <div class="toggle-container">
              <a id="light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      





<div class="post">

  <header class="post-header">
    <h2 class="post-title">Support Vector Machine Math and Optimization</h2>
    <p class="post-meta">December 29, 2021</p>
    <p class="post-tags">
      <a href="/blog/2021"> <i class="fas fa-calendar fa-sm"></i> 2021 </a>
      
      ¬† ¬∑ ¬†
        
        <a href="/blog/tag/machinelearning">
          <i class="fas fa-hashtag fa-sm"></i> machinelearning</a> ¬†
          
      

      
      ¬† ¬∑ ¬†
        
        <a href="/blog/category/notes">
          <i class="fas fa-tag fa-sm"></i> notes</a> ¬†
          
      

    </p>
  </header>

  <article class="post-content">
    <h2 id="math-basics">Math Basics</h2>

<p><a href="https://www.svm-tutorial.com/2016/09/duality-lagrange-multipliers/" target="_blank" rel="noopener noreferrer">source</a></p>

<h3 id="duality">Duality</h3>

<blockquote>

Optimization problems may be viewed from either of two perspectives, the primal problem or the dual problem. The solution to the dual problem provides a lower bound to the solution of the primal (minimization) problem

In general the optimal values of the primal and dual problems need not be equal. Their difference is called the duality gap

</blockquote>

<h3 id="contour-lines">Contour lines</h3>

<ul>
  <li>For each point on a line, the function returns the same value</li>
  <li>The darker the area is, the smallest the value of the function is</li>
</ul>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm10-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm10-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm10-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm10.png">

  </picture>

  

</figure>

<h3 id="hyperplane">Hyperplane</h3>

<blockquote>

In geometry, a hyperplane is a subspace whose dimension is one less than that of its ambient space. For example, if a space is 3-dimensional then its hyperplanes are the 2-dimensional planes, while if the space is 2-dimensional, its hyperplanes are the 1-dimensional lines.

</blockquote>

<h3 id="lagrange-multipliers">Lagrange multipliers</h3>

<ul>
  <li>Only works with equality constraints.</li>
  <li>The only one point where two vectors point in the same direction: it is the minimum of the objective function, under the constraint.</li>
</ul>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm11-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm11-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm11-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm11.png">

  </picture>

  

</figure>

<ul>
  <li>Lagrange told us that to find the minimum of a constrained function, we need to look or points were \(\triangledown f(x,y)=\lambda \triangledown g(x,y)\).</li>
  <li>So we get \(\triangledown L(x,y,\lambda) = \triangledown f(x,y)-\lambda \triangledown g(x,y)\). The partial derivative of \(x,y,\lambda\) would all be zero.</li>
</ul>

<h3 id="quadratic-programming">Quadratic Programming</h3>

<p><a href="https://www.youtube.com/watch?v=GZb9647X8sg" target="_blank" rel="noopener noreferrer">Remaining</a></p>

<h2 id="perceptron-classifier">Perceptron Classifier</h2>

<p><a href="https://www.youtube.com/watch?v=4Gac5I64LM4" target="_blank" rel="noopener noreferrer">source</a></p>

<p>We‚Äôll label the points into two labels {-1,1}, which gives us:</p>

<p>correct: \(y_{actual}*y_{predicted}&gt;0\)</p>

<p>wrong: \(y_{actual}*y_{predicted}&lt;0\)</p>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm2-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm2-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm2-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm2.png">

  </picture>

  

</figure>

<p>For two dimension:</p>

\[\theta = (\theta_0,\theta_1,\theta_2)^T\\
x = (1,x_1,x_2)^T\\\]

<p>The decision boundary line we got would be:</p>

\[\begin{aligned}
\theta^T*x=0\\
\theta_0+\theta_1*x_1+\theta_2*x_2=0
\end{aligned}\]

<p>We‚Äôll use iteration to find the line, for each missclassified point:</p>

\[\theta_{updated}=\theta_{original}+\alpha*y_{actual}*x\]

<h2 id="linearly-seperable-svm">Linearly Seperable SVM</h2>

<ul>
  <li>
    <p>Two classes are linearly separable, SVM is to find the line that seperates the classes as far away as possible.</p>
  </li>
  <li>
    <p><strong>Support Vector</strong>: Any instance located on the ‚Äústreet‚Äù, including its border. The decision boundary is entirely determined by the support vectors.</p>
  </li>
  <li>
    <p>SVM can output the confidence score by calculating the point‚Äôs distance from the decision boundary, byt there is no probability can be returned.</p>
  </li>
  <li>
    <p>SVM is sensitive to feature scales. Or it will neglect the smaller feature.</p>
  </li>
</ul>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm1-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm1-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm1-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm1.png">

  </picture>

  

</figure>

<ul>
  <li>Hard margin classification: cannot deal with outliers. Thus we‚Äôll use a more flexible model.</li>
</ul>

<h3 id="math">Math</h3>

<table>
  <tbody>
    <tr>
      <td>
<strong>Step1</strong>: With normalization $$</td>
      <td>x_i \theta+b</td>
      <td>= 1 \(, so the distance be\) \frac{1}{</td>
      <td>¬†</td>
      <td>\theta</td>
      <td>¬†</td>
      <td>} $$ .</td>
    </tr>
  </tbody>
</table>

<p><strong>Step2</strong>: We write down the primal form:</p>

<table>
  <tbody>
    <tr>
      <td>Maximize $$\frac{1}{</td>
      <td>¬†</td>
      <td>\theta</td>
      <td>¬†</td>
      <td>}$$</td>
    </tr>
    <tr>
      <td>Subject to min value of $$</td>
      <td>x_i\theta+b</td>
      <td>$$ equals to 1</td>
      <td>¬†</td>
      <td>¬†</td>
    </tr>
  </tbody>
</table>

<p>which could also be written as
Minimize \(||\theta||=\frac{1}{2} \theta \theta^T\)
Subject to \(|x_i\theta+b| \ge 1\)</p>

<p>Step3: We‚Äôd like to find the dual form. Using lagrange multiplier:</p>

\[L(\theta,b,\alpha)=\frac{1}{2} \theta \theta^T - \Sigma^N_{i=1} \alpha_i( y_i(x_i\theta+b)-1)\]

<p>We take the partial derivative of \(\theta, b\), and get:</p>

\[\theta = \Sigma^N_{i=1} \alpha_i y_i x_i\\
\Sigma^N_{i=1} \alpha_i y_i = 0\]

<p>Then we substitute the \(L(\theta,b,\alpha)\):</p>

<p>We need to maximize</p>

\[\begin{aligned}
L(\theta,b,\alpha) &amp;= \Sigma^N_{i=1} \alpha_i+\frac{1}{2} \theta \theta^T -\Sigma^N_{i=1} \alpha_i y_i x_i\theta\\
&amp;= \Sigma^N_{i=1} \alpha_i+\frac{1}{2}\Sigma^N_{i=1} \alpha_i y_i x_i \Sigma^N_{j=1} \alpha_j y_j x_j^T - \Sigma^N_{i=1} \alpha_i y_i x_i \Sigma^N_{j=1} \alpha_j y_j x_j^T \\
&amp;=\Sigma^N_{i=1} \alpha_i -\frac{1}{2}\Sigma^N_{i=1}\Sigma^N_{j=1} \alpha_i \alpha_j y_i y_j x_i x_j^T
\end{aligned}\]

<p>s.t. \(\alpha_i \ge 0\) and \(\Sigma^N_{i=1} \alpha_i y_i=0\)</p>

<p>As we can tell from the dual problem, the objective function now depends only on the Lagrange multipliers. Now we‚Äôll use quadratic programming to solve for the best \(\alpha\).</p>

<p>Then for training, we get \(\theta=\Sigma^N_{i=1}\alpha_i y_i x_i\), b we pick any support vector and calculate \(y_i(x_i\theta+b)=1\).</p>

<p>For testing, we calculate \(s\theta+b=\Sigma\alpha_i y_i x_i s^T+b\) where \(s\) is (1*d) vector of testing point.</p>

<h2 id="not-linearly-separable-svm">Not Linearly Separable SVM</h2>

<h3 id="kernel-trick">Kernel Trick</h3>

<p><strong>Idea 1: Use Polar Coordinates</strong>: for the ‚Äúcircle‚Äù seperable data, we can mapping the coordinate to polar coordinates.</p>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm3-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm3-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm3-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm3.png">

  </picture>

  

</figure>

<p><strong>Map Data to Higher Dimension</strong>:</p>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm12-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm12-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm12-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm12.png">

  </picture>

  

</figure>

<p><strong>Common Kernels</strong>:</p>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm13-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm13-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm13-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm13.png">

  </picture>

  

</figure>

<ul>
  <li>
    <p>Always try the linear kernel first (remember that LinearSVC is much faster than SVC(ker nel=‚Äùlinear‚Äù)), especially if the training set is very large or if it has plenty of features.</p>
  </li>
  <li>
    <p>If the training set is not too large, you should try the Gaussian RBF kernel as well; it works well in most cases.</p>
    <ul>
      <li>The Gaussian RBF kernel has two hyperparameters: <strong>gamma</strong>: the higher, the narrower of the bell-shape curve, the more irregular of the decision boundary. <strong>C</strong>: The higher the narrower the street, thus less violation and higher irregular.</li>
    </ul>
  </li>
</ul>

<h3 id="soft-margin">Soft Margin</h3>

<p>We can penalize the violated points by adding:</p>

<p>Minimize \(\frac{1}{2} \theta \theta^T + C\Sigma^N_{i=1}\xi_i\)
Subject to \(|x_i\theta+b| \ge 1-\xi_i\) Where \(\xi_i \ge 0\).</p>

<p>A smaller C value leads to a wider street but more margin violations</p>

<h3 id="complexity">Complexity</h3>

<figure>

  <picture>
    
      <source media="(max-width: 480px)" srcset="/assets/img/svm/svm14-480.webp"></source>
    
      <source media="(max-width: 800px)" srcset="/assets/img/svm/svm14-800.webp"></source>
    
      <source media="(max-width: 1400px)" srcset="/assets/img/svm/svm14-1400.webp"></source>
    

    <!-- Fallback to the original file -->
    <img class="img-fluid rounded z-depth-1" src="/assets/img/svm/svm14.png">

  </picture>

  

</figure>

<ul>
  <li>Gets dreadfully slow when the number of training instances gets large</li>
  <li>Perfect for complex but small or medium training sets, it scales well with the number of features, especially with sparse features (i.e., when each instance has few nonzero features).</li>
  <li>GD converges much more slowly than the methods based on QP.</li>
  <li>If there is millions of instances and a smaller number of features, it‚Äôs better to use primal form to optimize. The computational complexity of the primal form of the SVM problem is proportional tot he number of training instances m, while the comp. complexity of the dual form is proportional to a number between m^2 and m^3.<a href="https://quizlet.com/349584710/machine-learning-ch-5-flash-cards/" target="_blank" rel="noopener noreferrer">source</a>
</li>
</ul>


  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    ¬© Copyright 2022 Manqiu  L..
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" target="_blank" rel="noopener noreferrer">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="noopener noreferrer">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="noopener noreferrer">Unsplash</a>.

    
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
